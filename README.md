# The S3 Log Analyser

Interactive Frontend Development Milestone Project for Code Institute.

A web application to retrieve two common types of log files generated by Amazon's Web Services (AWS) and stored in its object storage system (S3). Specifically, S3 Access Logs and CloudFront Access Logs. The application interprets and visualises the data for the user as charts & tables.

Log files are retrieved using the AWS API with login credentials supplied by the user. Users have the option to store their credentials in the local browser for a future session if they wish.

Remote IP addresses in the access logs are ignored to anonymise the data. All processing is done locally in the browser using JavaScript.

## Demo

See [https://daveb.me.uk/the-s3-log-analyser/]. A demo is available by clicking on the 'Use DEMO Creds' button to load access credentials for an S3 bucket containing example log files. *NB hosting the source code locally will mean DEMO creds may not load correctly, use the demo site to avoid this.

Currently the app only works in Chrome browser as Firefox (and others untested) do not support the required regex 'look behind' assertion. Basic regex assertion compatibility checking implemented to to prevent use in Firefox & Edge browsers.

## UX

The purpose of the application is to provide a quick and easy way for a user to visualise the data contained in log files held within an S3 bucket. A typical example would be to view patterns of requests made to a website hosted in an S3 bucket or served through a CloudFront distribution. The charts and tables show relevant dimensions of the data for this purpose. The app is for users familiar with AWS and who have the required knowledge to switch on logging and generate access credentials for an S3 bucket (although limited help will be available in a help modal). The app is a single page website.

Currently the app supports 2 of AWS's log file types, see the site's help modal for more info. Users need to choose between whether they would lke to view S3 Access Logs OR CloudFront Access Logs as the two types will often represent the same information (i.e. if the user is logging CloudFront requests to a site hosted in the bucket as well as bucket access).

### User Stories

1. Correct flow for user interaction is enforced by input elements being disabled/enabled at the right times. It is not possible to break the application by clicking a button out of sequence.
2. The user interface is intuitive enough that an IT literate user with knowledge of AWS can use it without looking at the help documentation.
3. When filtering the logs to view by date, a user cannot break the application by selecting a date out of range or where no logs exist.
4. A user can use the help button at any time to bring up instructions on how to use the app.
5. The charts & tables are relevant to the purpose of presenting the data.
6. The charts and tables are dynamic where appropriate, responding to a user selecting a data filter in any other chart.
7. Where data values are missing in the log files, these are presented gracefully on the charts.
8. If a S3 bucket contains incorrectly formatted log files the application fails gracefully with a relevant error message.
9. Large data sets load fast enough to be usable.

## Features

- Locally saved API credentials (browser local storage)
- Extensive use of JS promises
- Error management including classification whether warning or fatal
- Automated un-zipping of CloudFront log files in .gz format using browser 'Content Encoding' header
- Dynamic population of date form elements min/max attributes using JS

### Future Additions

- Analyse different types of log files
- Display dates in other time zones
- Compatibility with other browsers
- Modify the date filter according to log type selected
- Visualise bar & line chart data in smaller increments than 1 day
- Change x-axis tick orientation according to number of ticks to prevent overlap

## Technologies

- HTML5
- CSS3
- JavaScript
- Libraries
    - Bootstrap (4.3.1)
    - jQuery (3.4.1)
    - AWS SDK for JS, S3 service only (2.461)
    - dc.js (3.0.12)
        - crossfilter.js (1.4.7)
        - d3.js (5.9.2)
    - FontAwesome (5.9.0)

## Testing

Throughout the building of the application I have tested each function as it was written using the JS console in browser developement tools.

To test the first stage of the app's logic, processing of log file names (AWS listObjects requests) I added dummy files with incorrectly formatted key names to my test bucket.

To test the 2nd & 3rd stages of the app's logic, parsing AWS getObject requests and generating charts, I copied some real log file content strings into the code. This meant I could extensively test the parsing and charting functions without making repeated API calls.

I also extensively tested the full flow with real log file data in my test S3 bucket.

After considering using an automated testing library I decided against this as it added little value to the testing process.

### Technical Challenges

- To manage a bucket containing a very large number of files I implemented a safety limit on the number of iterations of AWS list objects (at max 1000 per iteration). Get object request limit tbc.
- CloudFront logs are compressed using .gz format. Used Content Encoding header to get the browser to automatically decompress these without using an external JS library.

### User Story Testing

1. Extensive manual testing of the applications flow including asking a non-technical person to use the app.
2. TBC.
3. Manually tested by selecting out of range dates revealed a bug, rectified by added a 'no log files selected' error to code.
4. Yes, help button always available in header.
5. Compared the charts and tables against similar analytics tools already available in AWS and other website hosting.
6. Yes, pie charts and bar charts filter dynamically apart from those where the grouping of the data dimension makes is not possible.
7. Added code to the log file parsing functions to interpret '-' (AWS no data indicator) as 0 or ignored in the charts.
8. TBD.
9. TBC, ok up to 1000+ log files.

## Deployment

Deployed to a website served from AWS S3 bucket via CloudFront.

Scripts loaded after HTML via defer attribute. All JS & CSS minified for size.

## Credits

Code for function ensure_group_bins() taken from dc.js wiki.

### Content

All content produced by myself other than CSS & JS libraries as documented.

### Media

### Acknowledgements

- wireframe.cc (online wireframing tool)
- Bootstrap official documentation
- jQuery official documentation
- d3, dc & crossfilter official documentation
- https://animateddata.co.uk/articles/crossfilter/ - helped a lot with understanding crossfilter.
- HTML5 validator https://validator.w3.org/ TBD
- CSS3 validator https://jigsaw.w3.org/css-validator/ TBD